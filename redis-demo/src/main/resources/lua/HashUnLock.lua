---
--- 解锁
--- Generated by Luanalysis
--- Created by lcc.
--- DateTime: 2023/8/10 14:29
--- 如果锁是自己持有，锁上的计数器-1，返回true
--- 如果锁不是自己持有，返回false
---
local key = KEYS[1]
local value = ARGV[1]

if (redis.call("hexists",key,value)==0) then
    return 0
else
    local counter = redis.call("hincrby",key,value,-1)
    if (counter > 0) then
        return 1
    else
        redis.call("del",key)
        return 1
    end
end
